<div class="dashboard-container">
    <h1>Insurance Agent Dashboard</h1>

    <div class="cards-grid">
        <mat-card class="dashboard-card" (click)="navigateTo('enroll')">
            <mat-card-header>
                <mat-card-title>Enroll New Policy</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <p>Enroll a customer into a new insurance plan.</p>
            </mat-card-content>
            <mat-card-actions>
                <button mat-button>ENROLL NOW</button>
            </mat-card-actions>
        </mat-card>

        <mat-card class="dashboard-card" (click)="navigateTo('my-enrollments')">
            <mat-card-header>
                <mat-card-title>My Enrollments</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <p>View policies enrolled by you.</p>
            </mat-card-content>
            <mat-card-actions>
                <button mat-button>VIEW ALL</button>
            </mat-card-actions>
        </mat-card>
    </div>

    <div class="reports-section">
        <div style="display: flex; justify-content: flex-end; margin-top: 50px; margin-bottom: 20px;">
            <button mat-raised-button color="primary" (click)="toggleReports()">
                {{ showReports ? 'Hide Reports' : 'Show Reports' }}
            </button>
        </div>

        <div *ngIf="showReports">
            <h2 style="margin-bottom: 24px;">Reports & Analytics</h2>

            <div class="reports-grid"
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 24px; margin-bottom: 32px;">
                <mat-card class="chart-card" style="padding: 24px;">
                    <h3>Policies by Type</h3>
                    <div style="height: 350px; display: flex; justify-content: center; position: relative;">
                        <canvas baseChart [data]="donutChartData" type="doughnut"
                            [options]="donutChartOptions"></canvas>
                    </div>
                </mat-card>

                <mat-card class="chart-card" style="padding: 24px;">
                    <h3>Claims Overview</h3>
                    <div style="height: 300px; position: relative;">
                        <canvas baseChart [data]="claimsChartData" [options]="claimsChartOptions"
                            [type]="'bar'"></canvas>
                    </div>
                </mat-card>

                <mat-card class="chart-card" style="padding: 24px;">
                    <h3>Premium vs Payout (Global)</h3>
                    <div style="height: 300px; position: relative;">
                        <canvas baseChart [data]="premiumChartData" [options]="claimsChartOptions"
                            [type]="'bar'"></canvas>
                    </div>
                </mat-card>
            </div>

            <mat-card class="table-card" style="padding: 24px;">
                <h3>High Value Claims (> 70% of Coverage)</h3>
                <div style="overflow-x: auto; margin-top: 16px;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                                <th style="padding: 12px; text-align: left;">Claim #</th>
                                <th style="padding: 12px; text-align: left;">Customer</th>
                                <th style="padding: 12px; text-align: left;">Hospital</th>
                                <th style="padding: 12px; text-align: left;">Diagnosis</th>
                                <th style="padding: 12px; text-align: right;">Claim Amount</th>
                                <th style="padding: 12px; text-align: right;">Coverage Limit</th>
                                <th style="padding: 12px; text-align: right;">Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let claim of highValueClaims" style="border-bottom: 1px solid #eee;">
                                <td style="padding: 12px;">{{claim.claimNumber}}</td>
                                <td style="padding: 12px; font-weight: 500;">{{claim.customerName}}</td>
                                <td style="padding: 12px;">{{claim.hospitalName}}</td>
                                <td style="padding: 12px;">{{claim.diagnosis}}</td>
                                <td style="padding: 12px; text-align: right; color: #EF4444; font-weight: bold;">
                                    {{claim.claimAmount | currency:'INR'}}
                                </td>
                                <td style="padding: 12px; text-align: right; color: #10B981;">
                                    {{claim.coverageAmount | currency:'INR'}}
                                </td>
                                <td style="padding: 12px; text-align: right;">{{claim.submittedAt | date:'mediumDate'}}
                                </td>
                            </tr>
                            <tr *ngIf="highValueClaims.length === 0">
                                <td colspan="5" style="padding: 24px; text-align: center; color: gray;">No high value
                                    claims found.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </mat-card>
        </div>
    </div>
</div>